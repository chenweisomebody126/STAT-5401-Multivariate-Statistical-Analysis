{
    "contents" : "---\ntitle: \"HW5\"\noutput: html_document\n---\n### Wei Chen\n### ID:5207679\n\n### Ex4.12\nLet X~2~,...X~60~ be a random sample of size 60 from a four-variate normal distribution having mean $\\mu$ and covariance $\\Sigma$. Specify each of the following completely.    \n(a)The distribution of $\\bar{X}$    \n(b)The distribution of ($X_{1}-\\mu$)'$\\Sigma^{-1}$($X_{1}-\\mu$)   \n(c)The distribution of n($\\bar{X}-\\mu$)'$\\Sigma^{-1}$($\\bar{X}-\\mu$)  \n(d)The approximate distribution of n($\\bar{X}-\\mu$)'$S^{-1}$($\\bar{X}-\\mu$)     \nSolution:   \n(a)$\\bar{X}$ ~ $N_{4}$($\\mu$,$\\frac{1}{60}$$\\Sigma$)    \n(b)($X_{1}-\\mu$)'$\\Sigma^{-1}$($X_{1}-\\mu$)  ~ $\\chi_{4}$($\\alpha$)   \n(c)n($\\bar{X}-\\mu$)'$\\Sigma^{-1}$($\\bar{X}-\\mu$)  ~  $\\chi_{4}$($\\alpha$)     \n(d)As the CLT, approximately n($\\bar{X}-\\mu$)'$S^{-1}$($\\bar{X}-\\mu$) ~d  $\\chi_{4}$($\\alpha$)    \nAccurately, it follows (60-1)*4/(60-4)F~4,60-4~, which is 4.2F~4,56~    \n\n### Ex4.41    \nConsider the data on show removal in Ex3.20   \n(a)Consider on any possible outliers in a scatter plot of the original variables       \n(b)Determine the power transformation $\\hat{\\lambda_{1}}$ that makes the x~1~ values approximately normal.Construct a Q-Q plot of the transformed observations.    \n(c)Determine the power transformation $\\hat{\\lambda_{2}}$ that makes the x~2~ values approximately normal.Construct a Q-Q plot of the transformed observations.       \n(d)Determinr the power transformation for approximately bivariate normality using (4-40)      \nSolution:     \n(a) \nFirst load the data on snow removal\n```{r}\nsnow <-read.table('http://users.stat.umn.edu/~guxxx192/courses/wichern_data/t3-2.dat')\ncolnames(snow)<-c('x1','x2')\nlibrary(car)\nscatterplot(snow$x1,snow$x2,smoother= FALSE, reg.line=FALSE)\n```\nWe can see two points with large x1 and small x2 and one point with small x1 and large x2, which may be outliers.\n(b)   \nFirst check the optimal value of lambda   \n```{r}\nlibrary(MASS)\nres<-boxcox(snow$x1~1, lambda=seq(-2,2,0.01) )\nprint(lambda<-with(res,x[which.max(y)]))\n```\nChoose 0.05 as the $\\lambda_{1}$, conduct QQplot\n```{r}\nx1_transformed<-(snow$x2^(0.05)-1)/(0.05)\nqqnorm(x1_transformed,main=\"After transformed x1\")\nqqline(x1_transformed)\n```\n      \n(c)   \n```{r}\nres<-boxcox(snow$x2~1, lambda=seq(-2,2,0.01) )\nprint(lambda<-with(res,x[which.max(y)]))\n```\nChoose -0.7 as the $\\lambda_{2}$\n```{r}\nx2_transformed<-(snow$x2^(-0.7)-1)/(-0.7)\nqqnorm(x2_transformed,main=\"After transformed x2\")\nqqline(x2_transformed)\n```\n    \n(d)   \n```{r}\nres<-powerTransform(with(snow,cbind(x1,x2)) ~1)\nsummary(res)\n```\nThus the power tranformation for approximate bivariate normality is $\\lambda_{1}$=0.25,$\\lambda_{2}$=-0.75    \n\n## Ex5.1\n(a)Evaluating T^2^, for testing H~0~: $\\mu$'=[7,11], using the data\n\\[X= \\left( \\begin{array}{ccc}\n2 & 12\\\\\n8 & 9 \\\\\n6 & 9 \\\\\n8 & 10 \\end{array} \\right)\\] \n(b)Specify the distribution of T^2^ for the situation in (a)    \n(c)Using (a) and (b), test H~0~ at the %\\alpha% =0.05 level. What conclusion do you reach?    \nSolution:   \n(a)\n```{r}\nx_51 <-matrix(c(2, 8, 6, 8,12,9, 9, 10),nrow=4, ncol=2)\nxbar_51 <-colMeans( x_51)\nmu_51<-c(7,11)\nscov_51<-cov(x_51)\nprint(T2_51<- 4*t(xbar_51-mu_51) %*% solve(scov_51) %*% (xbar_51-mu_51))\n```\n            \n(b)\nT2_51 ~ (4-1)*2/(4-2) $F_{2,4-2}$($\\alpha$), which is 3$F_{2,2}$($\\alpha$)    \n(c) \nCalculate the quantile for F distrbution\n```{r}\n3*qf(1-0.05, df1=2,df2=2)\n```\nSince T2_51< 0.05th quantile, we can not reject the Null hypothesis.\n\n### Ex 5.3\n(a)Use expression (5-15) to calculate the T2 in Exercise 5.1    \n(b)Use the data in Exercise 5.1 to evaluate $\\Lambda$ in (5-13). Also, evaluate Wilks' lambda.   \nSolution:   \n(a)\n```{r}\nn=4\nSigma.hat <- (n-1) * scov_51/n\nSigma0.hat <- Sigma.hat + (xbar_51 - mu_51) %*% t(xbar_51 -mu_51)\nprint(T2 <- (n - 1) * det(Sigma0.hat)/det(Sigma.hat) -(n - 1))\n```\n(b)\n```{r}\nprint(LR_Statistic<-(det(Sigma.hat)/det(Sigma0.hat))^(n/2))\nprint(Wilk_lambda<-det(Sigma.hat)/det(Sigma0.hat))\n```\n### Problem2\n(a)   \nSince We have known population covariance is $\\Sigma_{0}$, the dimension of $\\theta_{0}$ space is 0.      \nThe loglikelihood function is $\\ell_{0}$=$\\ell$($\\mu_{0}$,$\\Sigma_{0}$)= -$\\frac{n}{2}$log|2$\\pi\\Sigma_{0}$|-$\\frac{1}{2}$tr($\\Sigma_{0}^{-1}\\sum_{i=1}^{n}$($X_{i}-\\mu_{0}$)'($X_{i}-\\mu_{0}$))+const        \n$\\ell_{1}$=$\\ell$($\\bar{X}$,$\\Sigma_{0}$)= -$\\frac{n}{2}$log|2$\\pi\\Sigma_{0}$|-$\\frac{1}{2}$tr($\\Sigma_{0}^{-1}\\sum_{i=1}^{n}$($X_{i}-\\bar{X}$)'($X_{i}-\\bar{X}$))+const    \n$\\ell_{1}$-$\\ell_{0}$=tr($\\Sigma_{0}^{-1}\\sum_{i=1}^{n}$($X_{i}-\\mu_{0}$)'($X_{i}-\\mu_{0}$))-tr($\\Sigma_{0}^{-1}\\sum_{i=1}^{n}$($X_{i}-\\bar{X}$)'($X_{i}-\\bar{X}$)) =$\\frac{n}{2}$tr($\\Sigma_{0}^{-1}$($\\bar{X}-\\mu_{0}$)'($\\bar{X}-\\mu_{0}$)) =n($\\bar{X}-\\mu_{0}$)'$\\Sigma^{-1}$($\\bar{X}-\\mu_{0}$)   \n-2log$\\lambda$=2($\\ell_{1}$-$\\ell_{0}$)=n($\\bar{X}-\\mu_{0}$)'$\\Sigma_{-1}$($\\bar{X}-\\mu_{0}$) ~ $\\chi_{p}^{2}$   \n(b)   \nLet Y~i~=a'X~i~   \nSince X~i~ are iid observations from N~p~($\\mu,\\Sigma_{0}$), Y~i~ are iid N(a'$\\mu$, a'$\\Sigma_{0}$a)   \nThe null hyposhesis H~0~: $\\mu=\\mu_{0}$ is true ,if and only if all null hypothesis of the form H~0~^a^: a'$\\mu$=a'$\\mu_{0}$ is true.   \n$\\bar{Y}$ ~ N~p~(a'$\\mu$,$\\frac{1}{n}a'\\Sigma_{0}a$)    \n$\\frac{\\bar{Y}-a'\\mu_{0}}{\\sqrt{\\frac{1}{n}a'\\Sigma_{0}a}}$ ~ N(a'($\\mu-\\mu_{0}$),1)    \nTo find maximum range of previous foluma, take the square   \n$max_{a\\not= 0}$($\\frac{\\bar{Y}-a'\\mu_{0}}{\\sqrt{\\frac{1}{n}a'\\Sigma_{0}a}}$)^2^ =n* $max_{a\\not= 0}$($\\frac{(a'(\\bar{X}-\\mu_{0})^{2}}{a'\\Sigma_{0}a}$) =n($\\bar{X}-\\mu_{0}$)'$\\Sigma_{0}^{-1}$($\\bar{X}-\\mu_{0}$) ~ $\\chi_{p}^{2}$        \n\n\n",
    "created" : 1457627407260.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1756411054",
    "id" : "B439CF71",
    "lastKnownWriteTime" : 1457710461,
    "path" : "~/Documents/MultiAnaly/HW5/HW5.Rmd",
    "project_path" : "HW5.Rmd",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "type" : "r_markdown"
}