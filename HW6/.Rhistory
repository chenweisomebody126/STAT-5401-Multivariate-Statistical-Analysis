URL <- "http://users.stat.umn.edu/~guxxx192/courses/wichern_data/t5-1.dat"
sweat <- read.table(URL,colnames=c("sweat.rate","sodium","potassium"))
```
Then we calculate the centre of interval as xbar. We calculate the sample covariance as scov.
sweat <- read.table(URL,col.names=c("sweat.rate","sodium","potassium"))
```
Then we calculate the centre of interval as xbar. We calculate the sample covariance as scov.
```{r}
xbar<-colMeans(sweat)
scov<-cov(sweat)
n<-nrows(sweat)
p<-ncols(sweat)
alpha<-0.05
radius<-sqrt((n-1)*p/(n-p)*qf(alpha, df1=p,df2=n-p,lower.tail=FALSE))
print(lower <- xbar-radius*sqrt(diag(scov)/n))
print(upper <-xbar+radius*sqrt(diag(scov)/n))
scov<-cov(sweat)
n<-nrow(sweat)
p<-ncol(sweat)
alpha<-0.05
radius<-sqrt((n-1)*p/(n-p)*qf(alpha, df1=p,df2=n-p,lower.tail=FALSE))
print(lower <- xbar-radius*sqrt(diag(scov)/n))
print(upper <-xbar+radius*sqrt(diag(scov)/n))
radius.bon<- qf(alpha/(2*p),df=n-1)
radius.bon<- qf(alpha/2/p,df=n-1)
radius.bon<- qf(alpha/p,df=n-1)
p
alpha
alpha/3
radius.bon<- qt(alpha/(2*p),df=n-1)
print(lower.bon<- xbar-radius.bon*sqrt(diag(scov)/n))
print(upper.bon<- xbar+radius.bon*sqrt(diag(scov)/n))
radius.bon<- qt(alpha/(2*p),df=n-1, lower.tail=False)
print(lower.bon<- xbar-radius.bon*sqrt(diag(scov)/n))
print(upper.bon<- xbar+radius.bon*sqrt(diag(scov)/n))
radius.bon<- qt(alpha/(2*p),df=n-1, lower.tail=FALSE)
print(lower.bon<- xbar-radius.bon*sqrt(diag(scov)/n))
print(upper.bon<- xbar+radius.bon*sqrt(diag(scov)/n))
URL<- 'http://users.stat.umn.edu/~guxxx192/courses/wichern_data/t5-12.dat'
bird<-read.table(URL,col.names= c('tail','wing'))
res<- powerTransform(bird~1)
library(car)
res<- powerTransform(bird~1)
res<- powerTransform(with(bird,cbind(tail,wing))~1)
summary(res)
qqnorm(bird$wing)
qqnorm(bird$tail)
res=powerTransform(cbind(bird$tail, bird$wing)~1)
summary(res)
testTransform(res,lambda=c(0.75,2.75))
x1<- bird$tail^0.75
x2<- bird$wing^2.75
x1<- (bird$tail)^0.75
x2<- (bird$wing)^2.75
x=cbind(x1,x2)
p<-ncol(x)
n<-nrow(x)
s<-cov(x)
alpha<- 1-0.95
radius<- sqrt(p*(n-1)/(n-p)*qf(alpha,df1=p, df2=n-p,lower.tail=FALSE))
par(mfrow=c(1,1))
ellipse(center=xbar,shape= s/n, radius=radius, add=FALSE)
xbar<-colMeans(x)
s<-cov(x)
alpha<- 1-0.95
radius<- sqrt(p*(n-1)/(n-p)*qf(alpha,df1=p, df2=n-p,lower.tail=FALSE))
par(mfrow=c(1,1))
ellipse(center=xbar,shape= s/n, radius=radius, add=FALSE)
abline(v=upper[1],lty=2)
plot(c(190^0.75, 275^2.75))
plot(190^0.75, 275^2.75)
ellipse(center=xbar,shape= s/n, radius=radius, add=FALSE)
plot(190^0.75, 275^2.75)
dev.off()
ellipse(center=xbar,shape= s/n, radius=radius, add=FALSE)
plot(190^0.75, 275^2.75)
ellipse(center=xbar,shape= s/n, radius=radius, add=FALSE)
plot(190^0.75, 275^2.75,add=TRUE)
ellipse(center=xbar,shape= s/n, radius=radius, add=FALSE)
points(190^0.75, 275^2.75)
print(mu<-190^0.75, 275^2.75)
print(mu<-c(190^0.75, 275^2.75)
print(lower_x<-xbar-radius)
print(mu<-c(190^0.75, 275^2.75))
print(lower_x<-xbar-radius)
print(upper_x<-xbar+radius)
print(lower_x<-xbar-sqrt(diag(s)/n)*radius)
print(upper_x<-xbar+sqrt(diag(s)/n)*radius)
points(190^0.75, 275^2.75,pch=19)
points(190^0.75, 275^2.75,pch=21)
dev.off()
ellipse(center=xbar,shape= s/n, radius=radius, add=FALSE)
points(190^0.75, 275^2.75,pch=21)
dev.off()
ellipse(center=xbar,shape= s/n, radius=radius, add=FALSE)
points(190^0.75, 275^2.75,pch=20)
lower_x[1]
lower_x[2]
lower_bird<- c((lower_x[1])^(-0.75),(lower_x[2])^(-2.75))
upper_bird<- c((upper_x[1])^(-0.75),(upper_x[2])^(-2.75))
print(lower_bird)
print(upper_bird)
5098751^(-2.7)
lower_bird<- c((lower_x[1])^(1/0.75),(lower_x[2])^(1/2.75))
upper_bird<- c((upper_x[1])^(1/0.75),(upper_x[2])^(1/2.75))
print(lower_bird)
print(upper_bird)
radius_bon_x<-qt(alpha/(2*p),df=n-1,lower.tail=FALSE)
lower_bon_x<-xbar-radius_bon_x*sqrt(diag(s)/n)
upper_bon_x<-xbar+ radius_bon_x*sqrt(diag(s)/n)
lower_bon_bird<- c((lower_bon_x[1])^(1/0.75),(lower_bon_x[2])^(1/2.75))
upper_bon_bird<- c((upper_bon_x[1])^(1/0.75),(upper_bon_x[2])^(1/2.75))
print(lower_bon_bird)
print(upper_bon_bird)
t5.13<-read.table('http://users.stat.umn.edu/~guxxx192/courses/wichern_data/t5-13.dat')
nrow(t5.13)
URL<-'http://users.stat.umn.edu/~guxxx192/courses/wichern_data/t5-13.dat'
milk<- read.table(URL, col.names=c('fuel','repair','capital'))
par(mfrow=c(3,1))
QQnorm(fuel)
qqnorm(fuel)
qqnorm(milek$fuel)
qqnorm(milk$fuel)
qqline(fuel)
qqline(milk$fuel)
dev.off()
par(mfrow=c(2,3))
qqnorm(milk$fuel)
qqline(milk$fuel)
qqnorm(milk$repair)
qqline(milk$repair)
qqnorm(milk$capital)
qqline(milk$capital)
scatterplot(milk$fuel~ milk$repair)
scatterplot(milk$repair~ milk$capital)
scatterplot(milk$capital~ milk$fuel)
dev.off()
par(mfrow=c(2,3))
qqnorm(milk$fuel)
qqline(milk$fuel)
qqnorm(milk$repair)
qqline(milk$repair)
qqnorm(milk$capital)
qqline(milk$capital)
scatterplot(milk$fuel~ milk$repair)
dev.off()
par(mfrow=c(2,3))
qqnorm(milk$fuel)
qqline(milk$fuel)
qqnorm(milk$repair)
qqline(milk$repair)
qqnorm(milk$capital)
qqline(milk$capital)
plot(milk$fuel~ milk$repair)
plot(milk$repair~ milk$capital)
plot(milk$capital~ milk$fuel)
milk[9,]
milk[21]
milk[21,]
point(milk[c(9,21),])
points(milk[c(9,21),])
dev.off()
par(mfrow=c(2,3))
qqnorm(milk$fuel)
dev.off()
par(mfrow=c(2,3))
qqf<-qqnorm(milk$fuel)
identify(qqf)
dev.off()
par(mfrow=c(2,3))
qqf<-qqnorm(milk$fuel)
identify(qqf)
qqline(milk$fuel)
qqnorm(milk$repair)
dev.off()
par(mfrow=c(2,3))
qqf<-qqnorm(milk$fuel)
identify(qqf)
qqline(milk$fuel)
qqr<-qqnorm(milk$repair)
identify(qqr)
qqline(milk$repair)
qqc<-qqnorm(milk$capital)
identify(qqc)
qqline(milk$capital)
plot(milk$fuel~ milk$repair)
points(milk[c(9,21),])
points()plot(milk$repair~ milk$capital)
points(milk[c(9,21),], pch=21,col='r')
points(milk[c(9,21),], pch=21,col='red')
plot(milk$repair~ milk$capital)
points(milk[c(9,21),], pch=21,col='red')
plot(milk$capital~ milk$fuel)
points(milk[c(9,21),c(1,2)], pch=21,col='red')
dev.off()
plot(milk$fuel~ milk$repair)
points(milk[c(9,21),c(1,2)], pch=21,col='red')
points(milk[c(9,21),c(2)],milk[c(9,21),c(1)], pch=21,col='red')
dev.off()
par(mfrow=c(2,3))
qqf<-qqnorm(milk$fuel)
identify(qqf)
qqline(milk$fuel)
qqr<-qqnorm(milk$repair)
identify(qqr)
qqline(milk$repair)
qqc<-qqnorm(milk$capital)
identify(qqc)
qqline(milk$capital)
plot(milk$fuel~ milk$repair)
points(milk[c(9,21),c(2)],milk[c(9,21),c(1)], pch=21,col='red')
plot(milk$repair~ milk$capital)
points(milk[c(9,21),c(3)],milk[c(9,21),c(2)], pch=21,col='red')
plot(milk$capital~ milk$fuel)
points(milk[c(9,21),c(1)],milk[c(9,21),c(3)], pch=21,col='red')
```
milk<-milk[-c(9,21),]
dev.off()
par(mfrow=c(2,3))
qqf<-qqnorm(milk$fuel)
qqline(milk$fuel)
qqr<-qqnorm(milk$repair)
qqline(milk$repair)
qqc<-qqnorm(milk$capital)
qqline(milk$capital)
plot(milk$fuel~ milk$repair)
points(milk[c(9,21),c(2)],milk[c(9,21),c(1)], pch=21,col='red')
plot(milk$repair~ milk$capital)
points(milk[c(9,21),c(3)],milk[c(9,21),c(2)], pch=21,col='red')
plot(milk$capital~ milk$fuel)
points(milk[c(9,21),c(1)],milk[c(9,21),c(3)], pch=21,col='red')
qqc<-qqnorm(milk$capital)
qqline(milk$capital)
plot(milk$fuel~ milk$repair)
q<-nrow(milk)
n<-ncol(milk)
alpha<-1-0.95
xbar<-colMeans(milk)
s<-cov(milk)
radius_bon_m<-qt(alpha/(a*p),df=n-1,lower.tail=FALSE )
radius_bon_m<-qt(alpha/(2*p),df=n-1,lower.tail=FALSE )
print(lower_bon_m<-xbar-radius_bon_m*sqrt(diag(s)/n))
print(upper_bon_m<-xbar+radius_bon_m*sqrt(diag(s)/n))
radius_m<-sqrt(p*(n-1)/(n-p)*qf(alpha, df1=p,df2=n-p,lower.tail=FALSE))
print(lower_m<-xbar-radius_m*sqrt(diag(s)/n))
print(upper_m<-xbar+radius_m*sqrt(diag(s)/n))
URL<- 'http://users.stat.umn.edu/~guxxx192/courses/wichern_data/t5-12.dat'
bird<-read.table(URL,col.names= c('tail','wing'))
library(car)
res<- powerTransform(with(bird,cbind(tail,wing))~1)
summary(res)
testTransform(res,lambda=c(0.75,2.75))
x1<- (bird$tail)^0.75
x2<- (bird$wing)^2.75
x=cbind(x1,x2)
p<-ncol(x)
n<-nrow(x)
xbar<-colMeans(x)
s<-cov(x)
alpha<- 1-0.95
radius<- sqrt(p*(n-1)/(n-p)*qf(alpha,df1=p, df2=n-p,lower.tail=FALSE))
dev.off()
ellipse(center=xbar,shape= s/n, radius=radius, add=FALSE)
points(190^0.75, 275^2.75, pch=20)
```
(b) For simultaneous T^2^ interval
```{r}
lower_x<-xbar-sqrt(diag(s)/n)*radius
upper_x<-xbar+sqrt(diag(s)/n)*radius
URL<- 'http://users.stat.umn.edu/~guxxx192/courses/wichern_data/t5-12.dat'
bird<-read.table(URL,col.names= c('tail','wing'))
library(car)
res<- powerTransform(with(bird,cbind(tail,wing))~1)
summary(res)
testTransform(res,lambda=c(0.75,2.75))
x1<- (bird$tail)^0.75
x2<- (bird$wing)^2.75
x=cbind(x1,x2)
p<-ncol(x)
n<-nrow(x)
xbar<-colMeans(x)
s<-cov(x)
alpha<- 1-0.95
radius<- sqrt(p*(n-1)/(n-p)*qf(alpha,df1=p, df2=n-p,lower.tail=FALSE))
dev.off()
ellipse(center=xbar,shape= s/n, radius=radius, add=FALSE)
```
check whether interval cantains $/mu_{1}$=190mm and $/mu_{2}$=275mm. We can see the male mean vectoe falls in the 95% interval and thus we can reject it.
```{r}
points(190^0.75, 275^2.75, pch=20)
```
par<-mfrow(c(1,3))
qqnorm(bird$tail)
qqline(bird$tail)
qqnorm(bird$wing)
qqline(bird$wing)
plot(bird$tail, bird$wing)
```
par<-mfrow(c(1,3))
qqnorm(bird$tail)
par(mfrow=c(1,3))
qqnorm(bird$tail)
qqline(bird$tail)
qqnorm(bird$wing)
qqline(bird$wing)
plot(bird$tail, bird$wing)
```
res<- powerTransform(with(bird,cbind(tail,wing))~1)
summary(res)
